#!@GUILE@ \
-e main
!#

;;; fossdem.scm -- Read FOSDEM schedule in iCalendar format.

;; Copyright (C) 2015 Artyom V. Poptsov <poptsov.artyom@gmail.com>
;;
;; This program is free software: you can redistribute it and/or
;; modify it under the terms of the GNU General Public License as
;; published by the Free Software Foundation, either version 3 of the
;; License, or (at your option) any later version.
;;
;; This program is distributed in the hope that it will be useful, but
;; WITHOUT ANY WARRANTY; without even the implied warranty of
;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
;; General Public License for more details.
;;
;; You should have received a copy of the GNU General Public License
;; along with this program.  If not, see <http://www.gnu.org/licenses/>.


;;; Commentary:

;; Read FOSDEM [1] schedule in iCalendar format and print it to stdout in
;; org-mode format.
;;
;; [1] https://fosdem.org/

;;; Code:

(use-modules (ice-9 popen)
             (srfi srfi-41)             ; streams
             ;; Guile-ICS
             (ics)
             (ics conv))

(setlocale LC_ALL "")

(define (main args)
  ;; We have to use 'curl' because 'http-get' from (web client) does
  ;; not work with HTTPS.
  (let ((p (open-input-pipe "curl 'https://fosdem.org/2017/schedule/ical'")))
    (stream-for-each ical-object->org-mode (ics->stream p))))

;;;

;; Local Variables:
;; Mode: Scheme
;; End:

;;; fosdem.scm ends here.
